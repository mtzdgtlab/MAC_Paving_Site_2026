RewriteEngine On

# Redirect www to non-www
RewriteCond %{HTTP_HOST} ^www\.macpavingandsealcoating\.com [NC]
RewriteRule ^(.*)$ https://macpavingandsealcoating.com/$1 [R=301,L]

# Force HTTPS
RewriteCond %{HTTPS} off
RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# Redirect old service URLs with .html to new structure
RedirectMatch 301 ^/installation\.html$ /services/paving-services-nj/driveway-installation/
RedirectMatch 301 ^/resurfacing\.html$ /services/paving-services-nj/driveway-resurfacing/
RedirectMatch 301 ^/replacement\.html$ /services/paving-services-nj/driveway-replacement/
RedirectMatch 301 ^/extension\.html$ /services/paving-services-nj/driveway-extension/
RedirectMatch 301 ^/sealcoating\.html$ /services/sealer-services-nj/sealcoating
RedirectMatch 301 ^/crack-filling\.html$ /services/sealer-services-nj/crack-filling
RedirectMatch 301 ^/line-striping\.html$ /services/sealer-services-nj/line-striping
RedirectMatch 301 ^/walkways\.html$ /services/concrete/walkways
RedirectMatch 301 ^/sidewalks\.html$ /services/concrete/sidewalks
RedirectMatch 301 ^/curbs\.html$ /services/concrete/curbs
RedirectMatch 301 ^/aprons\.html$ /services/concrete/aprons
RedirectMatch 301 ^/paver-installation\.html$ /services/belgium-blocks/
RedirectMatch 301 ^/paver-maintenance\.html$ /services/belgium-blocks/
RedirectMatch 301 ^/belgium-blocks\.html$ /services/belgium-blocks
RedirectMatch 301 ^/sod-installation\.html$ /services/landscaping/sod-installation
RedirectMatch 301 ^/drainage\.html$ /services/landscaping/drainage
RedirectMatch 301 ^/hauling\.html$ /services/landscaping/hauling
RedirectMatch 301 ^/power-wash\.html$ /services/landscaping/power-wash
RedirectMatch 301 ^/top-soil\.html$ /services/landscaping/top-soil

# Redirect old service URLs without .html
RedirectMatch 301 ^/installation$ /services/paving-services-nj/driveway-installation/
RedirectMatch 301 ^/resurfacing$ /services/paving-services-nj/driveway-resurfacing/
RedirectMatch 301 ^/replacement$ /services/paving-services-nj/driveway-replacement/
RedirectMatch 301 ^/extension$ /services/paving-services-nj/driveway-extension/
RedirectMatch 301 ^/sealcoating$ /services/sealer-services-nj/sealcoating
RedirectMatch 301 ^/crack-filling$ /services/sealer-services-nj/crack-filling
RedirectMatch 301 ^/line-striping$ /services/sealer-services-nj/line-striping
RedirectMatch 301 ^/walkways$ /services/concrete/walkways
RedirectMatch 301 ^/sidewalks$ /services/concrete/sidewalks
RedirectMatch 301 ^/curbs$ /services/concrete/curbs
RedirectMatch 301 ^/aprons$ /services/concrete/aprons
RedirectMatch 301 ^/pavers-installation$ /services/belgium-blocks/
RedirectMatch 301 ^/paver-maintenance$ /services/belgium-blocks/
RedirectMatch 301 ^/belgium-blocks$ /services/belgium-blocks
RedirectMatch 301 ^/sod-installation$ /services/landscaping/sod-installation
RedirectMatch 301 ^/drainage$ /services/landscaping/drainage
RedirectMatch 301 ^/hauling$ /services/landscaping/hauling
RedirectMatch 301 ^/power-wash$ /services/landscaping/power-wash
RedirectMatch 301 ^/top-soil$ /services/landscaping/top-soil

# Category redirects
RedirectMatch 301 ^/asphalt-paving$ /services/driveway-paving-nj

# Redirect legacy service directory URLs
RedirectMatch 301 ^/services/asphalt-paving/?$ /services/paving-services-nj/
RedirectMatch 301 ^/services/asphalt-paving/installation/?$ /services/paving-services-nj/driveway-installation/
RedirectMatch 301 ^/services/asphalt-paving/resurfacing/?$ /services/paving-services-nj/driveway-resurfacing/
RedirectMatch 301 ^/services/asphalt-paving/replacement/?$ /services/paving-services-nj/driveway-replacement/
RedirectMatch 301 ^/services/asphalt-paving/extension/?$ /services/paving-services-nj/driveway-extension/
RedirectMatch 301 ^/services/sealer/?$ /services/sealer-services-nj/
RedirectMatch 301 ^/services/sealer/sealcoating/?$ /services/sealer-services-nj/sealcoating/
RedirectMatch 301 ^/services/sealer/crack-filling/?$ /services/sealer-services-nj/crack-filling/
RedirectMatch 301 ^/services/sealer/line-striping/?$ /services/sealer-services-nj/line-striping/
RedirectMatch 301 ^/services/pavers/?$ /services/belgium-blocks/
RedirectMatch 301 ^/services/pavers/belgium-blocks/?$ /services/belgium-blocks/
RedirectMatch 301 ^/services/pavers/installation/?$ /services/belgium-blocks/
RedirectMatch 301 ^/services/pavers/maintenance/?$ /services/belgium-blocks/
RedirectMatch 301 ^/concrete$ /services/concrete
RedirectMatch 301 ^/pavers$ /services/belgium-blocks
RedirectMatch 301 ^/sealer$ /services/sealer-services-nj
RedirectMatch 301 ^/landscaping$ /services/landscaping

# Other old URLs
RedirectMatch 301 ^/services\.html$ /services
RedirectMatch 301 ^/contact\.html$ /contact
RedirectMatch 301 ^/index\.html$ /

# Block access to development files
<Files ~ "\.(py|csv|xlsx)$">
    Order deny,allow
    Deny from all
</Files>

# Block access to system files
<Files ~ "^\.">
    Order deny,allow
    Deny from all
</Files>
