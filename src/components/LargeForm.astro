---
const {
  title = "Request Your Paving Estimate",
  subtitle = "SEND US A MESSAGE",
  formAction = "https://formspree.io/f/mvgpzjbv",
  buttonText = "Send a Service Request",
} = Astro.props;
---

<section class="contact-page-section section-space">
  <div class="small-container">
    <div class="row">
      <div class="col-xxl-12 col-xl-12 col-lg-12">
        <div class="contact-page-form-area">
          <div class="title-box mb-40 wow fadeInLeft" data-wow-delay=".5s">
            <span class="section-sub-title text-align-center">{subtitle}</span>
            <h3 class="section-title mt-10">{title}</h3>
          </div>
          <div class="contact-page-form">
            <form action={formAction} method="POST" id="largeContactForm">
              <div class="row">
                <div class="col-lg-6">
                  <label for="name">Your Name*</label>
                  <input
                    type="text"
                    name="name"
                    id="name"
                    placeholder="Full Name*"
                    required
                  />
                </div>
                <div class="col-lg-6">
                  <label for="email">Your Email*</label>
                  <input
                    type="email"
                    name="email"
                    id="email"
                    placeholder="Email Address*"
                    required
                  />
                </div>
                <div class="col-lg-6">
                  <label for="phone">Your Phone*</label>
                  <input
                    type="tel"
                    name="phone"
                    id="phone"
                    placeholder="Phone Number*"
                    pattern="[0-9]{10}"
                    required
                  />
                </div>
                <div class="col-lg-6">
                  <label for="service">Required Service*</label>
                  <input
                    type="text"
                    name="service"
                    id="service"
                    placeholder="Driveway paving, sealcoating, etc.*"
                    required
                  />
                </div>
                <div class="col-lg-6">
                  <label for="address">Project Address*</label>
                  <input
                    type="text"
                    name="address"
                    id="address"
                    placeholder="Street, City, County*"
                    required
                  />
                </div>
                <div class="col-lg-6">
                  <label for="message">Project Notes</label>
                  <textarea
                    name="message"
                    id="message"
                    placeholder="Timeline, property type, or access notes"></textarea>
                </div>
                <div class="col-lg-12">
                  <button type="submit" class="primary-btn-1 btn-hover">
                    {buttonText} | <i class="fas fa-arrow-right"></i>
                  </button>
                </div>
              </div>
              <div id="largeFormMessage" class="mt-3" style="display: none">
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<script>
  document.addEventListener("DOMContentLoaded", () => {
    const contactForm = document.getElementById("largeContactForm");
    const formMessage = document.getElementById("largeFormMessage");

    if (
      contactForm instanceof HTMLFormElement &&
      formMessage instanceof HTMLElement
    ) {
      contactForm.addEventListener("submit", async (e) => {
        e.preventDefault();
        try {
          const response = await fetch(contactForm.action, {
            method: "POST",
            body: new FormData(contactForm),
            headers: {
              Accept: "application/json",
            },
          });

          if (response.ok) {
            formMessage.textContent =
              "Thank you for your message! We'll get back to you soon.";
            formMessage.style.color = "#FFFFFF";
            formMessage.style.fontWeight = "bold";
            formMessage.style.fontSize = "1.2em";
            contactForm.reset();
          } else {
            throw new Error("Form submission failed");
          }
        } catch (error) {
          formMessage.textContent =
            "Sorry, there was an error submitting your message. Please try again.";
          formMessage.style.color = "yellow";
        }
        formMessage.style.display = "block";
      });
    }
  });
</script>
